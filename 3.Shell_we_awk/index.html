
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pmitev.github.io/to-awk-or-not/3.Shell_we_awk/">
      
      
        <link rel="prev" href="../2.Teasing_with_grep/">
      
      
        <link rel="next" href="../4.Brief_commands/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>3.Shell we awk - To awk or not</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#3shell-we-awk" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="To awk or not" class="md-header__button md-logo" aria-label="To awk or not" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            To awk or not
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3.Shell we awk
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/pmitev/to-awk-or-not" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="To awk or not" class="md-nav__button md-logo" aria-label="To awk or not" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    To awk or not
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pmitev/to-awk-or-not" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.Simple_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.Simple examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.Teasing_with_grep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.Teasing with grep
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    3.Shell we awk
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    3.Shell we awk
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#q-ok-i-see-this-and-that-but-really-why-should-i-bother-with-awk" class="md-nav__link">
    <span class="md-ellipsis">
      Q: OK, I see this and that but really, why should I bother with awk?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#well-coins-countries-anything-else" class="md-nav__link">
    <span class="md-ellipsis">
      Well, coins, countries - anything else?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.Brief_commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.Brief commands
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../multiple_files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    &nbsp;&nbsp;a) Multiple files
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../arrays/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    &nbsp;&nbsp;b) Awk arrays
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.String_manipulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5.String manipulation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.One_line_programs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6.One line programs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Python_vs_awk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python vs. awk
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Exercises
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Exercises
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/Exercises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Warming up
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/01.Simple_arithmetic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01.Simple arithmetic *
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/02.Data_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02.Data extraction *
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/03.Data_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03.Data extraction **
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/04.Data_manipulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04.Data manipulation **
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/05.Easy_tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05.Easy tricks *
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/06.Bioinformaticians_corner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06.Bioinformaticians corner *
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/Advanced_data_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced data analysis ****
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/Carpool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Carpool ***
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/Difficult_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Difficult to extract data ****
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/mail-merge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mail merge ****
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/Scrubbing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scrubbing a web page **
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/String_manipulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    String manipulation **
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/awk-json/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Awk and json **
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Exercises/Linear_regression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple linear regresion ***
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Case_studies/List/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    = Case Studies =
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    More with awk
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            More with awk
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../More_awk/User_defined_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User defined functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../More_awk/Command_params/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameters on the command line
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../More_awk/Input_output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Input/Output to external program
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../More_awk/Running_average/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running averages
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Other/Fixed_size_fields/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fixed size fields
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Other/Backreferences/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backreferences
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.gnu.org/software/gawk/manual/html_node/Multiple-Line.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Line records
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../awk_bash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Awk or Bash
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Other/Localization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Localization problems
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="http://www.thegeekstuff.com/2011/06/awk-nawk-gawk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Awk vs. nawk vs. gawk
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Other/Binder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GitHub & Binder
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../handy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handy to have
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tinyutils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tinyutils
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Links/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Links
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../About/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#q-ok-i-see-this-and-that-but-really-why-should-i-bother-with-awk" class="md-nav__link">
    <span class="md-ellipsis">
      Q: OK, I see this and that but really, why should I bother with awk?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#well-coins-countries-anything-else" class="md-nav__link">
    <span class="md-ellipsis">
      Well, coins, countries - anything else?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="3shell-we-awk">3.Shell we awk!</h1>
<h2 id="q-ok-i-see-this-and-that-but-really-why-should-i-bother-with-awk">Q: OK, I see this and that but really, why should I bother with awk?</h2>
<hr />
<p>Indeed, why? Lets get back to our very first example with the coins.</p>
<div class="highlight"><span class="filename">coins.txt</span><pre><span></span><code>gold     1    1986  USA                 American Eagle
gold     1    1908  Austria-Hungary     Franz Josef 100 Korona
silver  10    1981  USA                 ingot
gold     1    1984  Switzerland         ingot
gold     1    1979  RSA                 Krugerrand
gold     0.5  1981  RSA                 Krugerrand
gold     0.1  1986  PRC                 Panda - silver lined
silver   1    1986  USA                 Liberty dollar
gold     0.25 1986  USA                 Liberty 5-dollar piece
silver   0.5  1986  USA                 Liberty 50-cent piece
silver   1    1987  USA                 Constitution dollar
gold     0.25 1987  USA                 Constitution 5-dollar piece
gold     1    1988  Canada              Maple Leaf
</code></pre></div>
<p>Let's, just for a moment, assume that the file contains thousands of lines and your task is to summarize how many coins from each country you have in the file. 
You can do it in some spreadsheet software, you can write a program in C, C++, Fortran, Python, Perl - I know. You can use a helicopter to travel pretty much everywhere, but are you going to use it for a visit to the nearby grocery store? </p>
<p>So, perhaps <strong>grep</strong> + <strong>wc</strong> is a good start. </p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>grep<span class="w"> </span>USA<span class="w"> </span>coins.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l
</code></pre></div>
<p>This will give you the number of coins (lines) that have USA in the description. Then you go over all possible countries that are in the file but how many? Do you create a list of all countries and then run a loop over it? Why not give it to awk and use some associative <a href="http://www.gnu.org/software/gawk/manual/gawk.html#Arrays">arrays</a> for this purpose?</p>
<div class="highlight"><span class="filename">count.awk</span><pre><span></span><code><span class="c1">#!/usr/bin/awk -f</span>

<span class="p">{</span> <span class="nx">data</span><span class="p">[</span><span class="o">$</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="o">$</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span>

<span class="nb">END</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">in</span> <span class="nx">data</span><span class="p">)</span> <span class="kr">print</span> <span class="s2">&quot;Country: &quot;</span> <span class="nx">i</span> <span class="s2">&quot; count: &quot;</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>This is written in a script file, but if you insist here is the one line equivalent.</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span> <span class="nx">awk</span> <span class="s1">&#39;{data[$4]++} END {for (i in data) print &quot;Country: &quot; i &quot; count: &quot; data[i]}&#39;</span> <span class="nx">coins</span><span class="p">.</span><span class="nx">txt</span>
</code></pre></div>
<p>Note that we neither defined the names of the countries nor their number in advance... The only restriction is that the name of the country should be a single word.</p>
<p>So, on every line <code class="highlight"><span class="p">{</span><span class="nx">data</span><span class="p">[</span><span class="o">$</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="o">$</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span></code> will address the element with the value of the 4<sup>th</sup> column in the array <code>data</code> and will be increased by one. No need to declare the array in advance, no need to pre-allocate the size or to dynamically allocate the array... Everything is done behind the scene for your convenience... and the price to pay is... speed. In this particular case (with the thousands line file) the speed is not a problem.</p>
<details>
<summary>Exercises</summary>
<ul>
<li>Can you change the program so that it will count how many gold and silver coins there are? ...how many coins for each year...</li>
<li>This was a small file. Let's try something large. Look at the content of the <code>dgrp2.vcf</code> file you have downloaded (look in the provided instructions on how to download it). Here is a description of the <a href="http://genome.ucsc.edu/FAQ/FAQformat.html#format10.1">VCF</a> format. <strong>Find out how many different chromosomes contains the file</strong>. The relevant information is in the first column. What other information you could easily extract? - data entries per chromosome, fractions...</li>
</ul>
</details>
<h2 id="well-coins-countries-anything-else">Well, coins, countries - anything else?</h2>
<hr />
<p>Hm, if you work regularly with unformatted text files, like output from some programs, where the numbers are mixed with a complimentary text - then keep reading...       <br />
Let's use the output from the Gaussian code as an example (<em>something from my research</em>).</p>
<p><div class="highlight"><span class="filename">gaussian.out</span><pre><span></span><code>  . . . ( more than 1 000 lines ) . . .
  ---------------------------------------------------------------------
<span class="hll">                      Distance matrix (angstroms):
</span>                    1          2          3          4          5
     1  O    0.000000
     2  H    0.963063   0.000000
     3  H    3.055408   2.200353   0.000000
     4  H    3.599651   2.649467   1.360343   0.000000
<span class="hll">     5  O    2.921061   1.978989   0.745120   0.995689   0.000000
</span>     6  H    1.853252   1.916060   3.229967   3.940127   3.023829
     7  H    3.373977   3.518394   4.584225   5.275136   4.356355
     8  O    2.872140   2.799938   3.649823   4.343776   3.416579
     9  H    3.899854   3.574193   2.560758   3.901261   3.205196
  . . . ( more than 1 000 lines ) . . .
 Hexadecapole moment (field-independent basis, Debye-Ang**3):
 XXXX=          -2970.5127 YYYY=          -1148.8478 ZZZZ=          -1274.6533 XXXY=           -394.6318
 XXXZ=            676.4844 YYYX=           -298.0473 YYYZ=             48.9948 ZZZX=            302.4536
 ZZZY=            111.2988 XXYY=           -793.1298 XXZZ=           -808.1397 YYZZ=           -454.2615
 XXYZ=            -73.3495 YYXZ=             82.5166 ZZXY=           -127.7147
 N-N= 4.131583513295D+02 E-N=-2.289173820990D+03  KE= 6.050114478748D+02
<span class="hll"> Counterpoise: corrected energy =    -693.356401084648
</span> Counterpoise: BSSE energy =       0.003357515766

 Test job not archived.
 1\1\NSC-NEOLITH\SP\RB3LYP\6-31++G(d,p)\H17O9(1-)\X_PAVMI\23-Mar-2012\0
 \\#B3LYP/6-31++G(d,p) Counterpoise=2 Charge SCF=Tight NoSymm\\OH- in H
 2O,std. LJ params. for H2O, MC/QM\\-1,1\O,0,0.,0.,0.\H,0,-0.836605,-0.
  . . . ( more lines ) . . .
</code></pre></div>
The numbers that I am interested in are in bold. There are <strong>56 such pairs</strong> in the whole <a href="https://github.com/pmitev/to-awk-or-not/raw/master/docs/data/gaussian.out">file</a>. I need them tabulated in simple, two-column file that is easy to read, analyze and plot. Here I will not discuss other solutions. Instead, here is a possible awk solution:</p>
<div class="highlight"><span class="filename">extract-gaussian.awk</span><pre><span></span><code><span class="c1">#!/usr/bin/awk -f</span>
<span class="nb">BEGIN</span> <span class="p">{</span> <span class="nx">AU2eV</span><span class="o">=</span> <span class="mf">27.211383</span> <span class="p">}</span>
<span class="sr">/Distance matrix/</span> <span class="p">{</span><span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="nx">rOH</span><span class="o">=</span> <span class="o">$</span><span class="mi">5</span><span class="p">}</span>
<span class="sr">/Counterpoise: corrected energy/</span> <span class="p">{</span> <span class="kr">printf</span> <span class="s2">&quot;%.12f %.6f\n&quot;</span><span class="p">,</span> <span class="nx">rOH</span><span class="p">,</span> <span class="o">$</span><span class="mi">5</span><span class="o">*</span><span class="nx">AU2eV</span> <span class="p">}</span>
</code></pre></div>
<p>Here is the result:
<div class="highlight"><pre><span></span><code><span class="hll">./extract-gaussian.awk gaussian.out
</span>
0.745120000000 -18867.186585
0.760120000000 -18867.562399
0.775121000000 -18867.891626
0.790119000000 -18868.178646
0.805120000000 -18868.427531
0.820119000000 -18868.641859
0.835121000000 -18868.824992
0.850121000000 -18868.979881
0.865120000000 -18869.109227
0.880121000000 -18869.215504
0.895120000000 -18869.300920
0.910121000000 -18869.367515
0.925120000000 -18869.417119
0.940121000000 -18869.451414
0.955119000000 -18869.471908
0.970120000000 -18869.479979
0.985120000000 -18869.476868
1.000120000000 -18869.463711
1.015120000000 -18869.441546
1.030121000000 -18869.411316
. . .
</code></pre></div></p>
<p><code class="highlight"><span class="nb">BEGIN</span><span class="p">{</span> <span class="nx">AU2eV</span><span class="o">=</span> <span class="mf">27.211383</span> <span class="p">}</span></code> simply defines a conversion factor from atomic units to eV.</p>
<p><code class="highlight"><span class="sr">/Distance matrix/</span><span class="p">{</span><span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="kr">getline</span><span class="p">;</span> <span class="nx">rOH</span><span class="o">=</span> <span class="o">$</span><span class="mi">5</span><span class="p">}</span></code> will match lines with the specified criteria, skip 6 lines, then accumulate the 5<sup>th</sup> column in variable rOH - the distance between an O and an H in the molecule of interest.</p>
<p><code class="highlight"><span class="sr">/Counterpoise: corrected energy/</span> <span class="p">{</span> <span class="kr">printf</span> <span class="s2">&quot;%.12f %.6f\n&quot;</span><span class="p">,</span> <span class="nx">rOH</span><span class="p">,</span> <span class="o">$</span><span class="mi">5</span><span class="o">*</span><span class="nx">AU2eV</span> <span class="p">}</span></code> will match the other interesting line, then prints the collected earlier rOH and corresponding energy converted in eV.</p>
<p>Reading the resulting file is trivial in any programming language or plotting program.</p>
<p>Look at this alternative solution that uses a smart trick to advance 6 lines after the <code class="highlight"><span class="sr">/Distance matrix/</span></code> line </p>
<details>
<summary>credits to Pavol Bauer, workshop 2017.01.13</summary>
<div class="highlight"><pre><span></span><code><span class="c1">#!/usr/bin/awk -f</span>
<span class="nb">BEGIN</span> <span class="p">{</span> <span class="nx">AU2eV</span><span class="o">=</span> <span class="mf">27.211383</span> <span class="p">}</span>
<span class="sr">/Distance matrix/</span> <span class="p">{</span><span class="nx">myNR</span><span class="o">=</span><span class="nb">NR</span><span class="p">}</span>
<span class="nb">NR</span><span class="o">==</span><span class="nx">myNR</span><span class="o">+</span><span class="mi">6</span>        <span class="p">{</span><span class="nx">rOH</span><span class="o">=$</span><span class="mi">5</span><span class="p">}</span>
<span class="sr">/Counterpoise: corrected energy/</span> <span class="p">{</span> <span class="kr">printf</span> <span class="s2">&quot;%.12f %.6f\n&quot;</span><span class="p">,</span> <span class="nx">rOH</span><span class="p">,</span> <span class="o">$</span><span class="mi">5</span><span class="o">*</span><span class="nx">AU2eV</span> <span class="p">}</span>
</code></pre></div>
</details>
<p>Other case studies that will be gradually collected for further inspiration.</p>
<details>
<summary>Exercises</summary>
<ul>
<li>Can you modify the script to print a third column with values from the line <code>Counterpoise: BSSE energy =       0.003357515766</code> also converted in eV?</li>
</ul>
</details>
<details>
<summary>gnuplot tips</summary>
<p>Here is an example how you can quickly visualize the results with <code>gnuplot</code>, directly from the output of the script.
<div class="highlight"><span class="filename">$ gnuplot</span><pre><span></span><code><span class="k">plot</span><span class="w"> </span><span class="s">&quot;&lt; ./extract-gaussian.awk gaussian.out&quot;</span><span class="w"> </span><span class="nb">with</span><span class="w"> </span><span class="n">lines</span>
</code></pre></div>
<img alt="image1" src="../images/extract-gaussian.png" /></p>
<p>Another example that visualizes the country distribution from the coins.txt data. Try to sort the output as earlier and plot on the fly.
<div class="highlight"><span class="filename">$ gnuplot</span><pre><span></span><code><span class="k">set</span><span class="w"> </span><span class="nb">boxwidth</span><span class="w"> </span><span class="mf">0.9</span><span class="p">;</span><span class="w"> </span><span class="k">plot</span><span class="w"> </span><span class="p">[</span><span class="o">:</span><span class="p">][</span><span class="mi">0</span><span class="o">:</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;&lt; ./count.awk coins.txt&quot;</span><span class="w"> </span><span class="nb">using</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">4</span><span class="o">:</span><span class="nf">xticlabels</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="nb">with</span><span class="w"> </span><span class="n">boxes</span>
</code></pre></div>
<img alt="image2" src="../images/count-1.png" /></p>
<p>Or visualizing the chromosome counting/distribution exercise... <code>histogram-discrete.awk</code> script is discussed <a href="../Case_studies/Discrete_histogram/">here</a>.
<div class="highlight"><span class="filename">$ gnuplot</span><pre><span></span><code><span class="k">set</span><span class="w"> </span><span class="nb">boxwidth</span><span class="w"> </span><span class="mf">0.9</span><span class="p">;</span><span class="w"> </span><span class="k">plot</span><span class="w"> </span><span class="p">[</span><span class="o">:</span><span class="p">][</span><span class="mi">0</span><span class="o">:</span><span class="p">]</span><span class="w"> </span><span class="s">&quot;&lt;grep -v ^# dgrp2.vcf | histogram-discrete.awk&quot;</span><span class="w"> </span><span class="nb">using</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="nf">xticlabels</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nb">with</span><span class="w"> </span><span class="n">boxes</span>
</code></pre></div>
<img alt="image3" src="../images/histogram-dgrp2.png" /></p>
</details>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      <!-- <a href="https://uppmax.uu.se/" target="_blank" rel="noopener"><img align="right" alt="Uppsala" src="https://pmitev.github.io/to-awk-or-not/images/Uppsala.png" /> </a> -->
      <!-- <a href="https://nbis.se/" target="_blank" rel="noopener"><img align="right" alt="NBIS" src="https://pmitev.github.io/to-awk-or-not/images/nbis.png" /> </a> -->
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "content.code.annotate", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>